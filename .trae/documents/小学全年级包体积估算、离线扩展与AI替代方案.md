## 产品范围与命名
- 应用名称：童字屋（面向小学全年级识字与用字）。
- 入口：手写识字、拍照选词/OCR、搜索查询；配套发音、笔顺、词组与例句。

## 初始字库规模与包体积估算
- 字库规模：小学全年级常用字约 2500–3000。
- 文本字典（拼音/部首/笔画/词组/例句，SQLite）：约 0.9–3.0 MB 安装；下载压缩后约 0.45–1.8 MB。
- 矢量笔顺（SVG/JSON，每字 3–8 KB）：约 9–24 MB。
- 示例图片（可选，每字 2–8 KB）：约 6–24 MB（建议后装包）。
- 发音音频：
  - 按音节/声调复用库：约 15–25 MB（与字数不线性增长，建议后装包）。
  - 若每字独立音频：约 24–90 MB（不推荐）。
- 识别模型：
  - 手写识别 TFLite：约 3–15 MB（新增类别对体积影响 <1 MB）。
  - OCR（拍照识字）：约 5–20 MB（量化后 3–8 MB）。
- 推荐首包（AAB）：仅内置文本字典 + 手写识别模型 → 约 20–40 MB；重资源（笔顺/音频/OCR/图片）按需下载，用户侧安装后总资源 30–60+ MB（分模块）。

## 离线字库扩展方案
- 包装策略：Android App Bundle + 动态特性模块 + Play Asset Delivery（或自研 CDN 资源包）。
- 数据形态：预置 `SQLite` 主库 + 增量包（gzip 压缩的 `SQL patch`/表级增量）；启用 FTS5 索引与页压缩。
- 版本/校验：`content_version` + 清单（JSON）+ SHA256 校验；差分更新与断点续传（`WorkManager`）。
- 资源分层：
  1. 核心文本字典（离线，随首包）。
  2. 笔顺矢量、音频、图片 → on‑demand asset pack；首用拉取、缓存淘汰（LRU）。
- 回滚与容错：资产下载失败使用最小可用集；增量合并失败自动回退到上一个版本。

## AI 作为字库替代的可行性
- 建议定位：AI 用于补充与生成（例句、近反义词、用法讲解），非替代权威字典数据。
- 技术路线：RAG（检索增强）— 本地字典作为事实源，AI 组装更自然的解释与示例。
- 部署选项：
  - 端侧小模型（TFLite/NCNN，指令微调 200–800M 参数）：体积 50–300 MB，性能依设备与量化而定；不适合首包。
  - 云端推理 + 本地缓存：首包不增大；需合规与家长控制；弱网用降级答复。
- 风险与对策：
  - 事实性/安全性：所有释义经检索源校验；对未覆盖内容显示“参考/生成”标签。
  - 隐私与成本：对话/生成内容匿名化上报；按用户选择启用 AI；提供纯离线模式。

## 拍照选词与识别（OCR）
- 使用场景：课本/作业拍照，框选词或字后查询。
- 流程：拍照→轻量预处理（灰度/去噪）→文字检测（DB/EAST）→中文识别（CRNN/Transformer）→行/词切分→高亮可选框→点选后跳转查询。
- 模型选择：
  - 端侧：PaddleOCR 移动版（NCNN/TFLite，中文优先，量化体积 3–8 MB）。
  - 云侧兜底：高精度 OCR（遇到复杂版式或极差光线时）。
- 交互：
  - 点击高亮词框；长按切换为逐字选择；双指缩放与拖拽。
  - 多字词建议：结合分词（jieba/自研词典）给出“词/字”两级选择。
- 隐私与权限：默认端侧推理，不上传图片；云侧兜底需要显式授权与开关。
- 体积与性能：OCR 模块作为动态特性，首次下载 3–8 MB；中端机 100–200ms/行，低端机 300–600ms/行。

## 前端设计（Apple 风格）
- 设计语言：大标题、卡片化、圆角与层级阴影、细腻动效；浅色优先，暗色可选。
- 字体与排版：中文优先可读性（思源黑体/苹方等），行距 1.4–1.6；大号点击目标（≥48dp）。
- 颜色：柔和高饱和点缀（童趣配色：蓝/橙/绿），背景用浅灰/乳白；状态色一致。
- 关键页面：
  - 首页：快捷入口（手写、拍照、搜索）、最近学习、今日生字卡片。
  - 手写页：大画布、候选条、撤销/清空、误写纠正与相似字提示。
  - 查询页：字卡（拼音/部首/笔画）、笔顺动画、词组与例句折叠卡、发音按钮。
  - 拍照识字页：摄像预览、检测框叠加层、词/字切换标签、结果侧滑卡。
  - 生字本：收藏/错题、进度与复习计划、闯关入口。
- 动效与微交互：卡片入场过渡、笔顺分步播放、发音按钮波纹反馈、成就徽章。
- 命名与品牌：童字屋可用；图标建议屋顶+字形融合，简洁圆角。

## 里程碑
- M1：核心字典与手写识别，首页/查询/生字本（2–3 周）。
- M2：矢量笔顺播放器与资源打包（1–2 周）。
- M3：OCR 动态模块与端侧识别 + 兜底（2 周）。
- M4：AI RAG 生成释义/例句（云端）与家长控制（2 周）。
- M5：按需下载与内容增量更新、监控与回滚（1–2 周）。

## 体积控制策略（首包 ≤40MB）
- 首包仅含：UI、文本字典、手写模型。
- 动态下载：笔顺/音频/OCR/图片。
- 压缩与裁剪：App Bundle、R8/ProGuard、WebP、SQLite 页压缩、资源去冗余与 minify。
- 端云协同：弱网优先显示离线内容；在线内容懒加载并缓存。